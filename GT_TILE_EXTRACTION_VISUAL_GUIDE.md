# GT Tileæå–å¯è§†åŒ–æŒ‡å—

## ğŸ¨ æ ¸å¿ƒæ¦‚å¿µå›¾è§£

### åœºæ™¯1: LRå’ŒGTå°ºå¯¸ç›¸åŒ

```
åŸå§‹LRå›¾ç‰‡: 128x128
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚             â”‚
     â”‚   128x128   â”‚  bicubic
     â”‚             â”‚  upsample    ä¸Šé‡‡æ ·LR: 512x512
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”€â”€â”€â”€â”€â”€â”€â”€>   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚                     â”‚
                                  â”‚                     â”‚
                                  â”‚      512x512        â”‚
                                  â”‚                     â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ Tileåˆ‡åˆ†
                                           â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Tile 1   â”‚ Tile 2   â”‚ Tile 3   â”‚
                      â”‚ 256x256  â”‚ 256x256  â”‚ 256x256  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ éœ€è¦å¯¹åº”çš„GT tile
                           â–¼

GTå›¾ç‰‡: 512x512
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â”‚     åæ ‡æ˜ å°„ï¼š
â”‚      512x512        â”‚     scale = 512 / 512 = 1.0
â”‚                     â”‚     GT tile = LR tile * 1.0
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ æå–å¯¹åº”åŒºåŸŸ
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GT Tile1 â”‚ GT Tile2 â”‚ GT Tile3 â”‚  â† åæ ‡å®Œå…¨å¯¹åº”
â”‚ 256x256  â”‚ 256x256  â”‚ 256x256  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åœºæ™¯2: GTå°ºå¯¸æ˜¯ä¸Šé‡‡æ ·LRçš„2å€

```
åŸå§‹LR: 128x128 â†’ ä¸Šé‡‡æ ·LR: 512x512

LR Tileåœ¨ä¸Šé‡‡æ ·ç©ºé—´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  (0, 256, 0, 256)   â”‚
â”‚        Tile 1       â”‚
â”‚      256x256        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ åæ ‡æ˜ å°„
         â–¼

GTå›¾ç‰‡: 1024x1024
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   â”‚
â”‚           scale_h = 1024/512 = 2  â”‚
â”‚           scale_w = 1024/512 = 2  â”‚
â”‚                                   â”‚
â”‚    GT tileåæ ‡:                   â”‚
â”‚    h: 0*2 = 0 â†’ 256*2 = 512       â”‚
â”‚    w: 0*2 = 0 â†’ 256*2 = 512       â”‚
â”‚                                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚   GT Tile 1         â”‚        â”‚
â”‚    â”‚   (0,512,0,512)     â”‚        â”‚
â”‚    â”‚   512x512           â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Resizeåˆ°LR tileå°ºå¯¸
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Tile 1  â”‚  â† æœ€ç»ˆç”¨äºç”Ÿæˆedge map
    â”‚ 256x256  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š è¯¦ç»†åæ ‡æ˜ å°„è¿‡ç¨‹

### å®Œæ•´æµç¨‹ç¤ºä¾‹

**è¾“å…¥å‚æ•°**:
- åŸå§‹LR: 256x256
- ä¸Šé‡‡æ ·LR: 2048x2048 (8x upscale)
- GT: 2048x2048
- vqgantile_size: 1280
- vqgantile_stride: 1000

#### Step 1: Tileåˆ‡åˆ†

```
ä¸Šé‡‡æ ·LR (2048x2048) è¢«åˆ‡åˆ†ä¸º:

Tileå¸ƒå±€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tile 1  â”‚ Tile 2  â”‚  é«˜åº¦: 0-1280, 1000-2048
â”‚ 1280x   â”‚ 1048x   â”‚  å®½åº¦: 0-1280, 1000-2048
â”‚ 1280    â”‚ 1280    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tile 3  â”‚ Tile 4  â”‚
â”‚ 1280x   â”‚ 1048x   â”‚
â”‚ 1048    â”‚ 1048    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tileåæ ‡:
- Tile 1: (0, 1280, 0, 1280)       â†’ 1280x1280
- Tile 2: (0, 1280, 1000, 2048)    â†’ 1280x1048
- Tile 3: (1000, 2048, 0, 1280)    â†’ 1048x1280
- Tile 4: (1000, 2048, 1000, 2048) â†’ 1048x1048

é‡å åŒºåŸŸ (æ©™è‰²):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ T1      â”‚ T2      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”    â”‚
â”‚    â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚    â”‚  â† æ°´å¹³é‡å 280åƒç´ 
â”‚    â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚  â† å‚ç›´é‡å 280åƒç´ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ T3      â”‚ T4      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Step 2: å¤„ç†Tile 1

```
LR Tile 1åæ ‡: (0, 1280, 0, 1280)
ä¸Šé‡‡æ ·LRç©ºé—´: 2048x2048
GTç©ºé—´: 2048x2048

è®¡ç®—ç¼©æ”¾å› å­:
scale_h = 2048 / 2048 = 1.0
scale_w = 2048 / 2048 = 1.0

æ˜ å°„åˆ°GTç©ºé—´:
h_start_gt = 0 * 1.0 = 0
h_end_gt = 1280 * 1.0 = 1280
w_start_gt = 0 * 1.0 = 0
w_end_gt = 1280 * 1.0 = 1280

æå–GT tile: gt_image[0:1280, 0:1280]

GTå›¾ç‰‡ (2048x2048):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•—           â”‚
â”‚ â•‘ GT Tile 1 â•‘           â”‚
â”‚ â•‘ 1280x1280 â•‘           â”‚
â”‚ â•‘           â•‘           â”‚
â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•           â”‚
â”‚                         â”‚
â”‚                         â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”ŸæˆEdge Map:
GT Tile (1280x1280) â†’ Cannyæ£€æµ‹ â†’ Edge Map (1280x1280)
```

#### Step 3: å¤„ç†Tile 2ï¼ˆè¾¹ç•Œtileï¼‰

```
LR Tile 2åæ ‡: (0, 1280, 1000, 2048)
å®é™…å°ºå¯¸: 1280x1048 (ä¸æ˜¯æ­£æ–¹å½¢ï¼)

è®¡ç®—:
scale = 1.0
h_start_gt = 0
h_end_gt = 1280
w_start_gt = 1000
w_end_gt = 2048

GT Tile 2: gt_image[0:1280, 1000:2048]
å®é™…å°ºå¯¸: 1280x1048

GTå›¾ç‰‡:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           â•”â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚           â•‘ GT Tile 2 â•‘ â”‚  â† å³è¾¹ç•Œtile
â”‚           â•‘ 1280x1048 â•‘ â”‚
â”‚           â•‘           â•‘ â”‚
â”‚           â•šâ•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                         â”‚
â”‚                         â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ³¨æ„: å°ºå¯¸æ˜¯1280x1048ï¼ŒåŒ¹é…LR tileçš„å°ºå¯¸
æ— éœ€resizeï¼Œç›´æ¥ç”Ÿæˆedge map
```

## ğŸ”¢ åæ ‡è®¡ç®—å…¬å¼è¯¦è§£

### åŸºç¡€å…¬å¼

```python
# ç»™å®š:
original_lr_size = (H_lr_orig, W_lr_orig)  # åŸå§‹LRå°ºå¯¸
upsampled_lr_size = (H_lr_up, W_lr_up)     # ä¸Šé‡‡æ ·åLRå°ºå¯¸
gt_size = (H_gt, W_gt)                      # GTå›¾ç‰‡å°ºå¯¸
tile_coords = (h_start, h_end, w_start, w_end)  # Tileåœ¨ä¸Šé‡‡æ ·ç©ºé—´çš„åæ ‡

# è®¡ç®—ç¼©æ”¾å› å­ï¼ˆå…³é”®ï¼ï¼‰
scale_h = H_gt / H_lr_up
scale_w = W_gt / W_lr_up

# æ˜ å°„åˆ°GTç©ºé—´
h_start_gt = int(h_start * scale_h)
h_end_gt = int(h_end * scale_h)
w_start_gt = int(w_start * scale_w)
w_end_gt = int(w_end * scale_w)

# æå–GT tile
gt_tile = gt_image[:, :, h_start_gt:h_end_gt, w_start_gt:w_end_gt]

# å¦‚æœéœ€è¦ï¼Œresizeåˆ°LR tileå°ºå¯¸
target_h = h_end - h_start
target_w = w_end - w_start
if gt_tile.shape[2] != target_h or gt_tile.shape[3] != target_w:
    gt_tile = F.interpolate(gt_tile, size=(target_h, target_w))
```

### ä¸ºä»€ä¹ˆæ˜¯H_gt / H_lr_upè€Œä¸æ˜¯H_gt / H_lr_origï¼Ÿ

âŒ **é”™è¯¯ç†è§£**:
```python
# è¿™æ ·æ˜¯é”™è¯¯çš„ï¼
scale = H_gt / H_lr_orig  # ä¾‹å¦‚: 2048 / 256 = 8

# é—®é¢˜: tileåæ ‡æ˜¯åœ¨ä¸Šé‡‡æ ·ç©ºé—´(2048x2048)ä¸­çš„
# ç”¨åŸå§‹LRç©ºé—´(256x256)çš„æ¯”ä¾‹ä¼šå¯¼è‡´åæ ‡é”™è¯¯
```

âœ… **æ­£ç¡®ç†è§£**:
```python
# è¿™æ ·æ˜¯æ­£ç¡®çš„ï¼
scale = H_gt / H_lr_up  # ä¾‹å¦‚: 2048 / 2048 = 1

# åŸå› : tileåæ ‡å·²ç»åœ¨ä¸Šé‡‡æ ·ç©ºé—´(2048x2048)ä¸­
# éœ€è¦ä»ä¸Šé‡‡æ ·ç©ºé—´ç›´æ¥æ˜ å°„åˆ°GTç©ºé—´
```

**å›¾è§£åŸå› **:
```
åŸå§‹LR (256)  â†’ [ä¸ç›¸å…³] â†’ Tileåæ ‡ä¸åœ¨è¿™ä¸ªç©ºé—´
     â†“
ä¸Šé‡‡æ ·LR (2048) â†’ [è¿™é‡Œï¼] â†’ Tileåæ ‡åœ¨è¿™ä¸ªç©ºé—´
     â†“                â†“
     â””â”€â”€â”€â”€â”€â”€â”€â”€æ˜ å°„â”€â”€â”€â”€â†’ GTç©ºé—´ (2048)
```

## ğŸ¯ å®é™…æ¡ˆä¾‹èµ°æŸ¥

### æ¡ˆä¾‹: 128x128 LR â†’ 512x512 HR

```
Step 1: è¯»å–LR
â”Œâ”€â”€â”€â”€â”€â”
â”‚ LR  â”‚  128x128
â””â”€â”€â”€â”€â”€â”˜

Step 2: ä¸Šé‡‡æ ·LR (4x)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Upsampled   â”‚  512x512
â”‚     LR      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: Tileåˆ‡åˆ† (å‡è®¾vqgantile_size=256, stride=200)
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ T1   â”‚ T2   â”‚ T3   â”‚  æ¯ä¸ª256x256
â”‚256x  â”‚256x  â”‚256x  â”‚  é‡å 56åƒç´ 
â”‚256   â”‚256   â”‚256   â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

åæ ‡:
- T1: (0, 256, 0, 256)
- T2: (0, 256, 200, 456)
- T3: (0, 256, 400, 512) â†’ å®é™…(0, 256, 256, 512)

Step 4: åŠ è½½GTå›¾ç‰‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GT      â”‚  512x512 (ä¸upsampled LRç›¸åŒ)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 5: æå–GT tiles (scale = 512/512 = 1.0)

GT Tile 1: gt[0:256, 0:256]
â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚GT T1 â”‚  256x256
â””â”€â”€â”€â”€â”€â”€â”˜

GT Tile 2: gt[0:256, 200:456]
   â”Œâ”€â”€â”€â”€â”€â”€â”
   â”‚GT T2 â”‚  256x256
   â””â”€â”€â”€â”€â”€â”€â”˜

GT Tile 3: gt[0:256, 256:512]
            â”Œâ”€â”€â”€â”€â”€â”€â”
            â”‚GT T3 â”‚  256x256
            â””â”€â”€â”€â”€â”€â”€â”˜

Step 6: ç”ŸæˆEdge Maps
â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚Edge1 â”‚   â”‚Edge2 â”‚   â”‚Edge3 â”‚  æ¯ä¸ª256x256
â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜

Step 7: å¤„ç†æ¯ä¸ªtile
LR T1 + Edge1 â†’ Process â†’ Result1
LR T2 + Edge2 â†’ Process â†’ Result2
LR T3 + Edge3 â†’ Process â†’ Result3

Step 8: é«˜æ–¯èåˆ
Result1 + Result2 + Result3 (with gaussian weights)
            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Final     â”‚  512x512
    â”‚   Result    â”‚  æ— ç¼æ‹¼æ¥
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” è¾¹ç•Œæƒ…å†µå¤„ç†

### æƒ…å†µ1: GT tileè¶…å‡ºè¾¹ç•Œ

```python
# é—®é¢˜: è®¡ç®—å‡ºçš„åæ ‡å¯èƒ½è¶…å‡ºGTå›¾ç‰‡èŒƒå›´
h_end_gt = 2500  # ä½†GTåªæœ‰2048

# è§£å†³: è¾¹ç•Œæ£€æŸ¥
h_end_gt = min(h_end_gt, H_gt)  # 2048

# ç»“æœ: tileå°ºå¯¸å¯èƒ½å°äºé¢„æœŸ
tile_h = h_end_gt - h_start_gt  # å¯èƒ½ < vqgantile_size
```

**å›¾è§£**:
```
è®¡ç®—å‡ºçš„GT tile (è¶…å‡ºèŒƒå›´):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GT Image    â”‚
â”‚                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â” â† è¶…å‡ºè¾¹ç•Œ
â”‚    â”‚  Tile      â”‚ X â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®é™…æå–çš„GT tile (æˆªæ–­):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     GT Image    â”‚
â”‚                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚  Tile      â”‚ â† æˆªæ–­åˆ°è¾¹ç•Œ
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒ…å†µ2: GTå°ºå¯¸å°äºä¸Šé‡‡æ ·LR

```
ä¸Šé‡‡æ ·LR: 2048x2048
GT: 1024x1024 (æ¯”è¾ƒå°)

scale = 1024 / 2048 = 0.5

LR Tile: (0, 1280, 0, 1280)
GT Tile: (0, 640, 0, 640)  â† åªæœ‰ä¸€åŠå¤§å°

è§£å†³: Resize GT tile
gt_tile = F.interpolate(gt_tile, size=(1280, 1280))

ç»“æœ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GT Tile    â”‚  â†’  â”‚  Resized GT Tile    â”‚
â”‚  640x640    â”‚     â”‚     1280x1280       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒ…å†µ3: éæ­£æ–¹å½¢tile

```
å›¾ç‰‡è¾¹ç•Œçš„tileå¯èƒ½ä¸æ˜¯æ­£æ–¹å½¢:

LRå›¾ç‰‡: 2048x2048
Tileè®¾ç½®: size=1280, stride=1000

æœ€åä¸€ä¸ªtile:
h: 1000 â†’ 2048 (å®é™…é«˜åº¦: 1048)
w: 1000 â†’ 2048 (å®é™…å®½åº¦: 1048)

GT Tileä¹Ÿæ˜¯éæ­£æ–¹å½¢:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚
â”‚             â”‚  â† 1048x1048
â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤„ç†: 
- Edge mapä¹Ÿä¼šæ˜¯1048x1048
- å®Œç¾åŒ¹é…ï¼Œæ— éœ€ç‰¹æ®Šå¤„ç†
```

## ğŸ“ é‡å åŒºåŸŸçš„é«˜æ–¯èåˆ

### é«˜æ–¯æƒé‡çŸ©é˜µ

```
å•ä¸ªtileçš„æƒé‡åˆ†å¸ƒ (256x256):

      0.1  0.3  0.5  0.7  0.9  1.0  0.9  0.7  0.5  0.3  0.1
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
0.1 â”‚ .   .   .   .   .   .   .   .   .   .   .          â”‚
0.3 â”‚ .   .   .   .   *   *   *   .   .   .   .          â”‚
0.5 â”‚ .   .   *   *   *   *   *   *   *   .   .          â”‚
0.7 â”‚ .   *   *   *   *   *   *   *   *   *   .          â”‚
0.9 â”‚ .   *   *   *   â–ˆ   â–ˆ   â–ˆ   *   *   *   .          â”‚  â† ä¸­å¿ƒæƒé‡æœ€é«˜
1.0 â”‚ .   *   *   *   â–ˆ   â–ˆ   â–ˆ   *   *   *   .          â”‚
0.9 â”‚ .   *   *   *   â–ˆ   â–ˆ   â–ˆ   *   *   *   .          â”‚
0.7 â”‚ .   *   *   *   *   *   *   *   *   *   .          â”‚
0.5 â”‚ .   .   *   *   *   *   *   *   *   .   .          â”‚
0.3 â”‚ .   .   .   .   *   *   *   .   .   .   .          â”‚
0.1 â”‚ .   .   .   .   .   .   .   .   .   .   .          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å›¾ä¾‹:
â–ˆ = æƒé‡1.0 (ä¸­å¿ƒ)
* = æƒé‡0.5-0.9
. = æƒé‡0.1-0.4 (è¾¹ç¼˜)
```

### é‡å åŒºåŸŸèåˆ

```
ä¸¤ä¸ªç›¸é‚»tileçš„é‡å åŒºåŸŸ:

Tile 1æƒé‡:          Tile 2æƒé‡:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1.0    0.5  â”‚      â”‚  0.5   1.0  â”‚
â”‚ 0.9    0.4  â”‚      â”‚  0.6   0.9  â”‚
â”‚ 0.8    0.3  â”‚      â”‚  0.7   0.8  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€é‡å â”€â”€â”€â”€â”˜

èåˆç»“æœ:
Result = (Tile1 * W1 + Tile2 * W2) / (W1 + W2)

åœ¨é‡å åŒºåŸŸ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹³æ»‘è¿‡æ¸¡          â”‚
â”‚  æ— æ˜æ˜¾æ¥ç¼        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ å…³é”®è¦ç‚¹æ€»ç»“

### âœ… æ­£ç¡®åšæ³•

1. **åæ ‡ç©ºé—´ä¸€è‡´æ€§**
   ```python
   # tileåæ ‡åœ¨ä¸Šé‡‡æ ·ç©ºé—´
   scale = H_gt / H_lr_upsampled  # âœ“ æ­£ç¡®
   ```

2. **è¾¹ç•Œæ£€æŸ¥**
   ```python
   h_end_gt = min(h_end_gt, H_gt)  # âœ“ é˜²æ­¢è¶Šç•Œ
   ```

3. **å°ºå¯¸åŒ¹é…**
   ```python
   if gt_tile.size != lr_tile.size:
       gt_tile = resize(gt_tile, lr_tile.size)  # âœ“ ä¿è¯åŒ¹é…
   ```

4. **é«˜æ–¯èåˆ**
   ```python
   spliter.update_gaussian(result, coords)  # âœ“ å¹³æ»‘æ‹¼æ¥
   ```

### âŒ å¸¸è§é”™è¯¯

1. **é”™è¯¯çš„ç¼©æ”¾å› å­**
   ```python
   scale = H_gt / H_lr_original  # âœ— é”™è¯¯ï¼
   ```

2. **å¿˜è®°è¾¹ç•Œæ£€æŸ¥**
   ```python
   gt_tile = gt[h_start:h_end, ...]  # âœ— å¯èƒ½è¶Šç•Œ
   ```

3. **å°ºå¯¸ä¸åŒ¹é…**
   ```python
   # GT tile: 512x512
   # LR tile: 256x256
   # ç›´æ¥ä½¿ç”¨ä¼šå‡ºé”™ï¼  # âœ—
   ```

4. **ç®€å•æ‹¼æ¥**
   ```python
   result = concat(tile1, tile2)  # âœ— ä¼šæœ‰æ¥ç¼
   ```

## ğŸ”— ä»£ç ä½ç½®

- **æ ¸å¿ƒå‡½æ•°**: `extract_tile_from_gt()` (line 175-230)
- **Spliterç±»**: `ImageSpliterWithEdge` (line 340-400)
- **ä½¿ç”¨ç¤ºä¾‹**: `sr_val_ddpm_text_T_vqganfin_oldcanvas_tile_edge.py` (line 600-650)

---

**æç¤º**: ç†è§£è¿™ä¸ªåæ ‡æ˜ å°„å…³ç³»æ˜¯æ­£ç¡®å®ç°tile-based edge processingçš„å…³é”®ï¼

