# EdgeMapGenerator æ–‡æ¡£å’Œæµ‹è¯•

è¿™ä¸ªç›®å½•åŒ…å«äº†EdgeMapGeneratorç±»çš„å®Œæ•´æ–‡æ¡£å’Œæµ‹è¯•è„šæœ¬ã€‚

## ğŸ“š æ–‡æ¡£åˆ—è¡¨

### 1. [å¿«é€Ÿå¼€å§‹æŒ‡å—](EDGE_QUICK_START.md)
**é€‚åˆ**: æ–°ç”¨æˆ·å¿«é€Ÿä¸Šæ‰‹

1åˆ†é’Ÿå¿«é€Ÿäº†è§£å¦‚ä½•ä½¿ç”¨EdgeMapGeneratorï¼š
- åŸºæœ¬ç”¨æ³•ç¤ºä¾‹
- å¸¸è§ä½¿ç”¨åœºæ™¯
- æœ€å°åŒ–ç¤ºä¾‹ä»£ç 

**æ¨èä¼˜å…ˆé˜…è¯»** â­

---

### 2. [è¯¦ç»†ä½¿ç”¨æŒ‡å—](EDGE_GENERATOR_USAGE.md)
**é€‚åˆ**: éœ€è¦æ·±å…¥äº†è§£APIå’Œé…ç½®

å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£ï¼š
- APIè¯¦ç»†è¯´æ˜
- æ‰€æœ‰å‚æ•°é…ç½®
- è®­ç»ƒå’Œæ¨ç†é›†æˆæ–¹æ³•
- å¸¸è§é—®é¢˜è§£ç­”
- è¿ç§»æŒ‡å—

---

### 3. [é‡æ„æ€»ç»“](EDGE_REFACTOR_SUMMARY.md)
**é€‚åˆ**: äº†è§£é‡æ„èƒŒæ™¯å’ŒæŠ€æœ¯ç»†èŠ‚

é‡æ„å·¥ä½œçš„å®Œæ•´è®°å½•ï¼š
- é‡æ„ç›®æ ‡å’ŒåŠ¨æœº
- å®Œæˆçš„å·¥ä½œæ¸…å•
- æµ‹è¯•ç»“æœ
- ä»£ç å¯¹æ¯”
- æŠ€æœ¯ç»†èŠ‚

---

### 4. [æ–‡ä»¶ç»“æ„è¯´æ˜](FILE_STRUCTURE.md)
**é€‚åˆ**: äº†è§£é¡¹ç›®æ–‡ä»¶ç»„ç»‡

å®Œæ•´çš„æ–‡ä»¶ç»„ç»‡ç»“æ„ï¼š
- æ–‡ä»¶ç›®å½•æ ‘
- å„æ–‡ä»¶è¯´æ˜
- å­¦ä¹ è·¯å¾„æ¨è
- ç›®å½•è®¾è®¡ç†å¿µ

---

## ğŸ§ª æµ‹è¯•è„šæœ¬

### [test_edge_generator.py](test_edge_generator.py)

å®Œæ•´çš„åŠŸèƒ½æµ‹è¯•å¥—ä»¶ï¼ŒåŒ…å«7ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š

```bash
# æ–¹å¼1: ä½¿ç”¨å¿«æ·è„šæœ¬
cd new_features/EdgeMapGenerator
./test_edge.sh

# æ–¹å¼2: ç›´æ¥è¿è¡Œæµ‹è¯•è„šæœ¬
conda activate sr_edge
python new_features/EdgeMapGenerator/test_edge_generator.py
```

æµ‹è¯•è¦†ç›–ï¼š
- âœ… Numpyæ•°ç»„è¾“å…¥æµ‹è¯•
- âœ… PyTorch Tensorè¾“å…¥æµ‹è¯•
- âœ… å•å¼ /æ‰¹é‡å›¾åƒæµ‹è¯•
- âœ… ä¾¿æ·å‡½æ•°æµ‹è¯•
- âœ… è‡ªå®šä¹‰å‚æ•°æµ‹è¯•
- âœ… çœŸå®å›¾åƒå¤„ç†æµ‹è¯•
- âœ… è®­ç»ƒ/æ¨ç†ä¸€è‡´æ€§æµ‹è¯•

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

å¦‚æœä½ åªæƒ³å¿«é€Ÿä½¿ç”¨EdgeMapGeneratorï¼š

```python
from basicsr.utils.edge_utils import EdgeMapGenerator

# åˆ›å»ºç”Ÿæˆå™¨
edge_gen = EdgeMapGenerator()

# è®­ç»ƒä¸­ä½¿ç”¨ (numpy, BGR, [0,1])
img_edge = edge_gen.generate_from_numpy(
    img_gt, 
    input_format='BGR', 
    normalize_input=True
)

# æ¨ç†ä¸­ä½¿ç”¨ (tensor, RGB, [-1,1])
edge_map = edge_gen.generate_from_tensor(
    lr_image, 
    input_format='RGB', 
    normalize_range='[-1,1]'
)
```

---

## ğŸ“‚ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| `README.md` | ~4KB | æ–‡æ¡£ç´¢å¼•å’Œå¯¼èˆª |
| `EDGE_QUICK_START.md` | ~3KB | å¿«é€Ÿå¼€å§‹æŒ‡å— |
| `EDGE_GENERATOR_USAGE.md` | ~6KB | è¯¦ç»†ä½¿ç”¨æ–‡æ¡£ |
| `EDGE_REFACTOR_SUMMARY.md` | ~7KB | é‡æ„å·¥ä½œæ€»ç»“ |
| `FILE_STRUCTURE.md` | ~6KB | æ–‡ä»¶ç»“æ„è¯´æ˜ |
| `test_edge_generator.py` | ~8KB | å®Œæ•´æµ‹è¯•å¥—ä»¶ |
| `test_edge.sh` | ~1KB | æµ‹è¯•å¿«æ·è„šæœ¬ |
| `test_edge_output.png` | ~34KB | æµ‹è¯•ç”Ÿæˆçš„æ ·ä¾‹edge map |
| `test_images/` | ~1.2MB | æµ‹è¯•å›¾ç‰‡ç›®å½•ï¼ˆ2å¼ æ ·ä¾‹å›¾ç‰‡ï¼‰ |

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒä»£ç 
- `../../basicsr/utils/edge_utils.py` - EdgeMapGeneratorç±»å®ç°

### ä½¿ç”¨ç¤ºä¾‹
- `../../basicsr/data/realesrgan_dataset.py` - è®­ç»ƒæ•°æ®é›†ä¸­çš„ä½¿ç”¨
- `../../predict.py` - æ¨ç†è„šæœ¬ä¸­çš„ä½¿ç”¨
- `../../scripts/sr_val_ddpm_text_T_vqganfin_old_edge.py` - éªŒè¯è„šæœ¬ä¸­çš„ä½¿ç”¨

---

## ğŸ“– æ¨èé˜…è¯»é¡ºåº

**é¦–æ¬¡ä½¿ç”¨**:
1. [å¿«é€Ÿå¼€å§‹æŒ‡å—](EDGE_QUICK_START.md) - äº†è§£åŸºæœ¬ç”¨æ³•
2. è¿è¡Œ `test_edge_generator.py` - éªŒè¯åŠŸèƒ½
3. åœ¨ä½ çš„ä»£ç ä¸­ä½¿ç”¨ - å¼€å§‹é›†æˆ

**æ·±å…¥å­¦ä¹ **:
1. [è¯¦ç»†ä½¿ç”¨æŒ‡å—](EDGE_GENERATOR_USAGE.md) - å­¦ä¹ æ‰€æœ‰åŠŸèƒ½
2. [é‡æ„æ€»ç»“](EDGE_REFACTOR_SUMMARY.md) - äº†è§£æŠ€æœ¯ç»†èŠ‚

---

## âœ¨ æ ¸å¿ƒä¼˜åŠ¿

âœ… **ç»Ÿä¸€æ€§**: è®­ç»ƒå’Œæ¨ç†ä½¿ç”¨å®Œå…¨ç›¸åŒçš„é€»è¾‘  
âœ… **ç®€æ´æ€§**: 3è¡Œä»£ç æ›¿ä»£28è¡Œæ‰‹åŠ¨å®ç°  
âœ… **å¯é æ€§**: ç»è¿‡å……åˆ†æµ‹è¯•ï¼Œå·®å¼‚ä¸º0  
âœ… **çµæ´»æ€§**: æ”¯æŒå¤šç§æ ¼å¼å’Œè‡ªå®šä¹‰å‚æ•°  

---

## ğŸ› é—®é¢˜åé¦ˆ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [è¯¦ç»†ä½¿ç”¨æŒ‡å—](EDGE_GENERATOR_USAGE.md) çš„å¸¸è§é—®é¢˜éƒ¨åˆ†
2. è¿è¡Œæµ‹è¯•è„šæœ¬ç¡®è®¤ç¯å¢ƒé…ç½®
3. æ£€æŸ¥ç›¸å…³ä»£ç ç¤ºä¾‹

---

**æœ€åæ›´æ–°**: 2025-10-15  
**æµ‹è¯•çŠ¶æ€**: âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡  
**å…¼å®¹æ€§**: âœ… å‘åå…¼å®¹

