# 菜单快速指南

## 📋 新菜单（3个选项）

```bash
./run_auto_inference.sh

==================================================
           StableSR Edge 推理菜单
==================================================

1. 推理指定目录下全部 checkpoint (edge & no-edge & dummy-edge)

2. 推理指定 checkpoint 文件 (edge & no-edge & dummy-edge)

3. 生成推理结果报告 (CSV格式)

0. 退出

==================================================
```

---

## 🎯 选项说明

### 选项1：批量推理

推理指定目录下的**所有** checkpoint

**特点**：
- ✅ 自动处理多个 checkpoint
- ✅ 三种模式（edge, no-edge, dummy-edge）
- ✅ 可选批次限制
- ✅ 可选重新计算指标
- ✅ 智能跳过已有结果
- ✅ 自动生成报告

**适用场景**：
- 定期运行所有新 checkpoint
- 完整的实验评估
- 批量处理

---

### 选项2：单个 checkpoint 推理 ⭐ 新改进

推理**指定**的单个 checkpoint

**特点**：
- ✅ **自动运行三种模式**（edge, no-edge, dummy-edge）
- ✅ 自动计算所有5个指标
- ✅ 可选生成综合报告
- ✅ 快速验证

**流程**：
```
输入参数 → 确认配置 → 推理三种模式 → 显示结果 → 生成报告(可选)
```

**适用场景**：
- 测试单个 checkpoint
- 快速验证某个 epoch
- 对比三种模式效果

---

### 选项3：生成报告

从已有的推理结果生成 CSV 报告

**特点**：
- ✅ 汇总所有指标
- ✅ CSV 格式，易于分析
- ✅ 自动排序（按 epoch）
- ✅ 包含5个指标

**适用场景**：
- 重新生成报告
- 更新报告
- 数据分析

---

## 🆕 主要改动

### 合并选项2和3

**之前**：
- 选项2：edge 模式
- 选项3：no-edge 模式

**现在**：
- 选项2：**三种模式全部运行**

**优势**：
- 一次运行完成
- 自动计算所有指标
- 结果更完整

---

## 💡 快速使用

### 场景A：处理所有新 checkpoint

```bash
./run_auto_inference.sh
1 → 回车 → 回车 → 回车 → 回车 → 回车
# 全自动
```

### 场景B：测试单个 checkpoint

```bash
./run_auto_inference.sh
2 → 输入checkpoint路径 → 其他默认 → 回车
# 自动运行三种模式
```

### 场景C：生成报告

```bash
./run_auto_inference.sh
3 → 输入结果目录 → 回车
# 生成 CSV 报告
```

---

## 📊 输出指标

所有模式都会自动计算**5个指标**：

1. **PSNR** - 图像质量 (↑ 越大越好)
2. **SSIM** - 结构相似度 (↑ 越大越好)
3. **LPIPS** - 感知质量 (↓ 越小越好)
4. **Edge PSNR** - 边缘精确度 (↑ 越大越好)
5. **Edge Overlap** - 边缘覆盖率 (↑ 越大越好)

---

## 🎯 推荐使用

| 场景 | 推荐选项 | 理由 |
|-----|---------|------|
| 日常批量处理 | 选项1 | 自动化程度最高 |
| 测试单个模型 | 选项2 | 快速验证三种模式 |
| 重新生成报告 | 选项3 | 不重复推理 |
| 对比不同epoch | 选项1 | 完整数据 |
| 调试特定checkpoint | 选项2 | 快速反馈 |

---

## 🎊 总结

**新菜单特点**：
- ✅ 3个选项，更简洁
- ✅ 选项2合并，更强大
- ✅ 自动计算5个指标
- ✅ 一次运行三种模式
- ✅ 功能完整，使用简单

---

**快速开始**：
```bash
conda activate sr_infer
./run_auto_inference.sh
```

**详细文档**：`new_features/L2Loss/MENU_UPDATES.md`

